```
package com.sky.properties;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

@Component
@ConfigurationProperties(prefix = "sky.alioss")
@Data
public class AliOssProperties {

    private String endpoint;
    private String accessKeyId;
    private String accessKeySecret;
    private String bucketName;

}
```
下面我用 **GitHub 可直接查看的 Markdown 格式**，**逐个解释你这个类里的注解含义 + 它们配合起来是干什么的**。

你可以直接复制保存成 `alioss-properties.md`。

---

# `@Component`、`@ConfigurationProperties`、`@Data` 注解详解

示例代码：

```java
package com.sky.properties;

import lombok.Data;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

@Component
@ConfigurationProperties(prefix = "sky.alioss")
@Data
public class AliOssProperties {

    private String endpoint;
    private String accessKeyId;
    private String accessKeySecret;
    private String bucketName;

}
```

---

## 一、整体作用（先看这个）

> **这个类的作用：**
> 把 `application.yml / application.properties` 中的
> `sky.alioss` 配置，自动映射成一个 Java 对象。

---

## 二、`@ConfigurationProperties`

### 1️⃣ 注解含义

```java
@ConfigurationProperties(prefix = "sky.alioss")
```

> 将 **配置文件中的属性**，按照前缀规则，**绑定到 Java 对象的属性上**。

---

### 2️⃣ 配置文件示例

```yaml
sky:
  alioss:
    endpoint: oss-cn-beijing.aliyuncs.com
    access-key-id: xxx
    access-key-secret: yyy
    bucket-name: my-bucket
```

---

### 3️⃣ 绑定规则（重点）

| 配置文件              | Java 属性         |
| ----------------- | --------------- |
| endpoint          | endpoint        |
| access-key-id     | accessKeyId     |
| access-key-secret | accessKeySecret |
| bucket-name       | bucketName      |

📌 **支持：**

* `-`
* `_`
* 驼峰

---

### 4️⃣ 优点（相比 `@Value`）

* 批量绑定
* 类型安全
* 易维护
* 支持复杂对象

---

## 三、`@Component`

### 1️⃣ 注解含义

```java
@Component
```

> 把当前类 **交给 Spring 容器管理**，变成一个 Bean。

---

### 2️⃣ 为什么必须要有？

`@ConfigurationProperties` **只负责“绑定配置”**，
**不负责“创建对象”**。

所以必须配合以下方式之一：

* `@Component`（你现在用的）
* `@EnableConfigurationProperties`
* `@ConfigurationPropertiesScan`

📌 **否则这个类不会生效**。

---

### 3️⃣ Bean 使用方式

```java
@Autowired
private AliOssProperties aliOssProperties;
```

---

## 四、`@Data`（Lombok）

### 1️⃣ 注解含义

```java
@Data
```

> 自动生成 **Getter / Setter / toString / equals / hashCode**。

---

### 2️⃣ 等价于：

```java
@Getter
@Setter
@ToString
@EqualsAndHashCode
```

---

### 3️⃣ 为什么必须有 Getter / Setter？

`@ConfigurationProperties` **是通过 Setter 注入值的**。

📌 没有 Setter → 属性绑定失败。

---

## 五、三个注解组合后的效果

```text
application.yml
     ↓
@ConfigurationProperties  →  属性绑定
@Component                →  Spring 管理
@Data                     →  Getter / Setter
     ↓
AliOssProperties Bean
```

---

## 六、运行时流程（非常重要）

1. Spring Boot 启动
2. 扫描到 `@Component`
3. 创建 `AliOssProperties` Bean
4. 读取 `sky.alioss` 配置
5. 通过 Setter 注入值
6. Bean 可在任何地方注入使用

---

## 七、常见错误 & 排查

### ❌ 1️⃣ 配置不生效

原因：

* 忘了加 `@Component`
* 包路径未被扫描

---

### ❌ 2️⃣ 属性为 null

原因：

* 配置 key 写错
* 没有 Setter
* 前缀不匹配

---

### ❌ 3️⃣ 使用 `@Value` 混着用

不推荐：

```java
@Value("${sky.alioss.endpoint}")
private String endpoint;
```

---

## 八、推荐最佳实践（强烈建议）

### ✔ 写法 1（你现在的，最常见）

```java
@Component
@ConfigurationProperties(prefix = "sky.alioss")
@Data
public class AliOssProperties {}
```

---

### ✔ 写法 2（Spring Boot 2.2+ 推荐）

```java
@ConfigurationProperties(prefix = "sky.alioss")
@Data
public class AliOssProperties {}
```

```java
@ConfigurationPropertiesScan
@SpringBootApplication
public class Application {}
```

---

## 九、一句话总结

> * `@ConfigurationProperties`：绑定配置
> * `@Component`：交给 Spring
> * `@Data`：生成 Setter / Getter
>
> **三者配合 = 优雅地读取配置文件**

---

如果你愿意，我可以继续帮你讲：

* `@ConfigurationProperties` vs `@Value`
* 多环境（dev/test/prod）下的配置加载
* 阿里云 OSS 客户端如何优雅注入
* 如何对配置做 **校验**（`@Validated`）

你挑一个，我继续 👌
